/*! jQuery UI Virtual Keyboard Typing Simulator v1.12.0 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&"object"==typeof module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(p){p.fn.addTyping=function(e){var t={showTyping:!0,lockTypeIn:!1,delay:250,hoverDelay:250},r=p.keyboard;return this.each(function(){var o,a=p(this).data("keyboard");a&&(o=a.typing_options=p.extend({},t,e),a.typing_keymap={" ":"space",'"':"34","'":"39","&nbsp;":"space","\b":"bksp","{b}":"bksp","{d}":"del","{l}":"left","{r}":"right","\n":"enter","\r":"enter","{e}":"enter","\t":"tab","{t}":"tab"},a.typing_xref={8:"bksp",9:"tab",13:"enter",32:"space",37:"left",39:"right",46:"del"},a.typing_event=!1,a.typing_namespace=a.namespace+"typing",a.extensionNamespace.push(a.typing_namespace),o.savedLockInput=a.options.lockInput,a.typing_setup_reset=function(){var e=r.events,t=a.typing_namespace,e=[e.kbHidden,e.kbInactive,""].join(t+" ");a.$el.unbind(t).bind(e,function(){a.typing_reset()}),a.unbindButton(t).bindButton("mousedown"+t,function(){a.typing_reset()})},a.typing_setup=function(){var e=a.typing_namespace;a.typing_setup_reset(),a.$el.bind(r.events.kbBeforeVisible+e,function(){a.typing_setup()}),a.$preview.unbind(e).bind("keyup"+e,function(e){return!(o.init&&o.lockTypeIn||!o.showTyping)&&void(37<=e.which&&e.which<=40||(16===e.which&&(a.shiftActive=!1),18===e.which&&(a.altActive=!1),16!==e.which&&18!==e.which||(a.showSet(),setTimeout(function(){a.$preview&&a.$preview.focus()},200))))}).bind("keydown"+e,function(e){return!(o.init&&o.lockTypeIn||!o.showTyping)&&(e.temp=!1,16===e.which&&(e.temp=!a.shiftActive,a.shiftActive=!0),18===e.which&&(e.temp=!a.altActive,a.altActive=!0),e.temp&&(a.showSet(),a.$preview.focus()),a.typing_event=!0,void(a.typing_xref[e.which]&&a.typing_findKey("",e)))}).bind("keypress"+e,function(e){return(!o.init||!o.lockTypeIn)&&void(a.typing_event&&!a.options.lockInput&&(a.typing_reset(),a.typing_event=!0,a.typing_findKey("",e)))})},a.typing_reset=function(){a.typing_event=o.init=!1,o.text="",o.len=o.current=0,a.options.lockInput=o.savedLockInput},a.typeIn=function(e,t,n,i){if(!a.isVisible())return clearTimeout(a.typing_timer),void a.typing_reset();a.typing_event?void 0===e&&(a.typing_event=!1,a.options.lockInput=o.savedLockInput):(!0!==o.init&&(o.init=!0,a.options.lockInput=o.lockTypeIn,o.text=e||o.text||"",o.len=o.text.length,o.delay=t||o.delay,o.current=0,n&&(o.callback=n)),"{"===(e=o.text.substring(o.current,++o.current))&&"}"===o.text.substring(o.current+1,o.current+2)&&(e+=o.text.substring(o.current,o.current+=2)),a.typing_findKey(e,i))},a.typing_findKey=function(e,t){var n,i,p,y=r.css,s=r.builtLayouts[a.layout].mappedKeys;a.isOpen&&a.$keyboard.length&&(p=a.$keyboard.find("."+y.keySet),n=e in a.typing_keymap?a.typing_keymap[e]:e,n="."+y.keyButton+'[data-action="'+n+'"]',a.typing_event&&t&&(n="keypress"!==t.type&&a.typing_xref.hasOwnProperty(t.keyCode||t.which)?"."+y.keyPrefix+a.processName(a.typing_xref[t.keyCode||t.which]):(i=String.fromCharCode(t.charCode||t.which),s.hasOwnProperty(i)?"."+y.keyButton+'[data-value="'+s[i].replace(/"/g,'\\"')+'"]':"."+y.keyPrefix+a.processName(i))),(i=p.filter(":visible").find(n)).length?a.typing_simulateKey(i,e,t):(y=(i=a.typing_event?p.find(n):(n=e in a.typing_keymap?a.typing_keymap[e]:a.processName(e),p.find("."+y.keyPrefix+n))).closest("."+y.keySet)).attr("name")?(o.showTyping&&(y=y.attr("name"),a.shiftActive=/shift/.test(y),a.altActive=/alt/.test(y),a.metaActive=a.last.keyset[2]=!!/\bmeta/.test(y)&&y.match(/meta[\w-]+/)[0],a.showSet(a.metaActive)),a.typing_simulateKey(i,e,t)):a.typing_event||(e in a.typing_keymap&&a.typing_keymap[e]in r.keyaction?r.keyaction[a.typing_keymap[e]](a,i,t):a.insertText(e),a.checkCombos(),a.$el.trigger(r.events.kbChange,[a,a.el])),o.current<=o.len&&0!==o.len?a.isVisible()&&(a.typing_timer=setTimeout(function(){a.typeIn()},o.delay)):0!==o.len?(a.typing_reset(),"function"==typeof o.callback&&(a.typing_timer=setTimeout(function(){"function"==typeof o.callback&&o.callback(a)},o.delay))):a.typing_reset())},a.typing_simulateKey=function(e,t,n){var i=e.length;a.isVisible()&&(o.showTyping&&i&&(e.filter(":visible").trigger("mouseenter"+a.namespace),o.showTyping&&i&&setTimeout(function(){e.trigger("mouseleave"+a.namespace)},Math.min(o.hoverDelay,o.delay))),a.typing_event||setTimeout(function(){t in a.typing_keymap&&a.typing_keymap[t]in r.keyaction?((n=n||p.Event("keypress")).target=e,r.keyaction[a.typing_keymap[t]](a,e,n)):a.insertText(t),a.checkCombos(),a.$el.trigger(r.events.kbChange,[a,a.el])},o.delay/3))},o.showTyping&&a.options.alwaysOpen&&a.isVisible()?a.typing_setup():a.$el.unbind(r.events.kbBeforeVisible+a.typing_namespace).bind(r.events.kbBeforeVisible+a.typing_namespace,function(){o.showTyping?a.typing_setup():a.typing_setup_reset()}))})}});
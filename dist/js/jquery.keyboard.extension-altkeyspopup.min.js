/*! jQuery UI Virtual Keyboard Alt Key Popup v2.0.0 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&"object"==typeof module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(s){"use strict";var l=s.keyboard;s.extend(l.css,{altKeyPopup:"ui-keyboard-popup",altKeyOverlay:"ui-keyboard-overlay",altKeyPopupOpen:"ui-keyboard-popup-open"}),l.altKeys=s.extend({a:"å æ ā ă ą à á â ã ä",A:"Å Æ Ā Ă Ą À Á Â Ã Ä",c:"ç ć ĉ ċ č",C:"Ç Ć Ĉ Ċ Č",d:"ď ð ď",D:"Ď Ð Ď",e:"ė ę ĕ ě ə è é ê ë ē",E:"Ė Ę Ĕ Ě Ǝ È É Ê Ë Ē",g:"ģ ğ ĝ ġ",G:"Ģ Ğ Ĝ Ġ",h:"ĥ ħ",H:"Ĥ Ħ",i:"ı į ī ï î í ì ĩ ĭ",I:"İ Į Ī Ï Î Í Ì Ĩ Ĭ",j:"ĵ",J:"Ĵ",k:"ķ",K:"Ķ",l:"Ł Ľ Ļ Ĺ Ŀ",L:"ł ľ ļ ĺ ŀ",n:"ŉ ň ņ ń ñ",N:"ŉ Ň Ņ Ń Ñ",o:"œ ő ø ö õ ô ó ò ō ŏ",O:"Œ Ő Ø Ö Õ Ô Ó Ò Ō Ŏ",r:"ŕ ř ŗ",R:"Ŕ Ř Ŗ",s:"ś š ş ß § ŝ",S:"Ś Š Ş ẞ § Ŝ",t:"þ ť ț ţ ŧ",T:"Þ Ť Ț Ţ Ŧ",u:"ų ű ů ū ü û ú ù ũ ŭ",U:"Ų Ű Ů Ū Ü Û Ú Ù Ũ Ŭ",w:"ŵ",W:"Ŵ",y:"ý",Y:"Ý",z:"ź ż ž",Z:"Ź Ż Ž","!":"¡",$:"€ £ ¤ ¥ ¢ ₡ ₱ ₩ ₹ ₪ ₭ ₮ ₦ ₤","?":"¿","'":"〈 「 『 “",'"':"〉 」 』 ”","(":"《 【 〔",")":"》 】 〕"},l.altKeys),s.fn.addAltKeyPopup=function(e){var p={holdTime:500,popupVisible:"popup-visible",popupHidden:"popup-hidden",popupPosition:null};return this.each(function(){var u=s(this).data("keyboard");if(u){if(u.altkeypopup_options=s.extend({},p,u.altkeypopup_options,e),u.altkeypopup_namespace)return u.altkeypopup_setup();u.altkeypopup_namespace=u.namespace+"AltKeyPopup",u.extensionNamespace.push(u.altkeypopup_namespace),u.altkeypopup_setup=function(){var n,e="mousedown touchstart ".split(" ").join(u.altkeypopup_namespace+" "),p="mouseup touchend touchcancel ".split(" ").join(u.altkeypopup_namespace+" ");u.options.repeatRate=0,u.unbindButton(u.altkeypopup_namespace).bindButton(e,function(){clearTimeout(n);var e=s(this),p=e.attr("data-value")||"",o=u.altkeypopup_options.holdTime;p in l.altKeys&&(o?n=setTimeout(function(){u.altKeyPopup_popup(p,e)},o):u.altKeyPopup_popup(p,e))}).bindButton(p,function(){clearTimeout(n)}),u.altkeypopup_blockingFlag=!1,u.$preview.unbind("keypress keydown keyup ".split(" ").join(u.altkeypopup_namespace+" ").trim()).bind("keypress keydown keyup ".split(" ").join(u.altkeypopup_namespace+" "),function(e){if("keyup"===e.type)return clearTimeout(n),u.altkeypopup_blockingFlag=!1,"Escape"!==e.key;var p=l.builtLayouts[u.layout],o=s(e.target),t=e.key,a=e.key;return"keydown"===e.type&&a in l.altKeys?u.altkeypopup_blockingFlag!==t&&(u.altkeypopup_blockingFlag=t,!0):u.altkeypopup_blockingFlag?((a=p.hasMappedKeys&&p.mappedKeys.hasOwnProperty(a)?p.mappedKeys[a]:a)in l.altKeys&&(clearTimeout(n),n=setTimeout(function(){u.altkeypopup_blockingFlag===t&&u.altKeyPopup_popup(a,o)},u.altkeypopup_options.holdTime)),!0):void 0})},u.altKeyPopup_close=function(){u.altkeypopup_blockingFlag=!1,u.altKeyPopup_$overlay=null,setTimeout(function(){var e;u.$keyboard.length&&(u.$keyboard.removeClass(l.css.altKeyPopupOpen),(e=u.$keyboard.find("."+l.css.altKeyOverlay))&&e.remove())},1),s(document).unbind(u.altkeypopup_namespace),u.$preview.focus(),u.options.ignoreEsc=u.altKeyPopup_savedIgnoreEsc,u.$el.trigger(u.altkeypopup_options.popupHidden,[u])},u.altKeyPopup_popup=function(e,p){var o,t,a,n,i;u.$keyboard.find("."+l.css.altKeyOverlay).length||(n=l.css,i={$kb:u.$keyboard,kbWidth:u.$keyboard.outerWidth(),kbHeight:u.$keyboard.outerHeight(),$key:p},u.altKeyPopup_$overlay=s('<div class="'+n.altKeyOverlay+'" />').css({width:i.kbWidth,height:i.kbHeight}).appendTo(u.$keyboard).bind("click touchstart",function(){u.altKeyPopup_close()}),a="inactive hidden ".split(" ").join(u.altkeypopup_namespace+" "),u.$keyboard.addClass(l.css.altKeyPopupOpen),u.$el.unbind(a).bind(a,function(){u.altKeyPopup_close()}),"bksp"!==e&&l.keyaction.bksp(u),o=s('<div class="'+n.altKeyPopup+" "+u.options.css.container+'" />'),a=l.altKeys[e].split(/\s+/),u.buildRow(o,0,a,[]),t=o.appendTo(u.altKeyPopup_$overlay).children().bind("mousedown touchstart",function(){u.altKeyPopup_close()}).bind("mouseover mouseleave",function(e){t.removeClass(u.options.css.buttonHover),"mouseleave"!==e.type&&s(this).addClass(u.options.css.buttonHover)}),u.altKeyPopup_navigate(!0),u.altKeyPopup_savedIgnoreEsc=u.options.ignoreEsc,u.options.ignoreEsc=!0,s(document).unbind(u.altkeypopup_namespace).bind("keydown"+u.altkeypopup_namespace,function(){return!1}).bind("keyup"+u.altkeypopup_namespace,function(e){return"Escape"===e.key?(e.which=0,u.altKeyPopup_close()):u.altKeyPopup_navigate(e),!1}),e=(i.$popup=o).outerWidth(),(a=p.position().left-e/2)+e>i.kbWidth&&(a=i.kbWidth-e)<0&&o.css({width:i.kbWidth,height:"auto"}),e=p.position().top-p.outerHeight()-5,p=o.outerHeight(),n=u.$keyboard.find("."+n.keySet).position().top,e+p>i.kbHeight&&(e=i.kbHeight-p)<n&&o.css({height:i.popupHeight,width:"auto"}),i.popupWidth=o.outerWidth(),i.popupHeight=o.outerHeight(),i.popupLeft=a<0?0:a,i.popupTop=e<n?n:e,o.css({position:"absolute",left:i.popupLeft,top:i.popupTop}),"function"==typeof u.altkeypopup_options.popupPosition&&u.altkeypopup_options.popupPosition(u,i),u.$preview.blur(),u.$el.trigger(u.altkeypopup_options.popupVisible,[u]))},u.altKeyPopup_navigate=function(e){var p,o=l.css,t=(l.navigationKeys,u.options.css.buttonHover),o=u.$keyboard.find("."+o.altKeyPopup).find("."+o.keyButton),a=o.length-1;if(!0===e)return o.eq(0).addClass(t),void(u.altKeyPopup_currentIndex=0);if(p=u.altKeyPopup_currentIndex,"Enter"===e.key)return u.insertText(o.eq(p).attr("data-value")),u.altKeyPopup_close(),!0;switch(e.key){case"End":p=a;break;case"Home":p=0;break;case"ArrowLeft":--p;break;case"ArrowRight":p+=1}u.altKeyPopup_currentIndex=p=a<(p=p<0?0:p)?a:p,o.removeClass(t).eq(p).addClass(t)},u.options.alwaysOpen&&u.isVisible()&&u.altkeypopup_setup(),u.$el.unbind(l.events.kbBeforeVisible+u.altkeypopup_namespace).bind(l.events.kbBeforeVisible+u.altkeypopup_namespace,function(){u.altkeypopup_setup()})}})}});